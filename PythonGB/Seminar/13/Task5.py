'''
–ó–∞–¥–∞–Ω–∏–µ ‚Ññ5
üìå –î–æ—Ä–∞–±–æ—Ç–∞–µ–º –∑–∞–¥–∞—á–∏ 3 –∏ 4. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å –ø—Ä–æ–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã:
üìå –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (—Ñ—É–Ω–∫—Ü–∏—è –∏–∑ –∑–∞–¥–∞–Ω–∏—è 4)
üìå –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É - —Ç—Ä–µ–±—É–µ—Ç —É–∫–∞–∑–∞—Ç—å –∏–º—è –∏ id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ
–º–∞–≥–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ï—Å–ª–∏ —Ç–∞–∫–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç, –≤—ã–∑—ã–≤–∞–π—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞.
–ê –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—Å—Ç—å, –ø–æ–ª—É—á–∏—Ç–µ –µ–≥–æ —É—Ä–æ–≤–µ–Ω—å –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
üìå –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ï—Å–ª–∏ —É—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–µ–Ω—å—à–µ, —á–µ–º –≤–∞—à —É—Ä–æ–≤–µ–Ω—å, –≤—ã–∑—ã–≤–∞–π—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –¥–æ—Å—Ç—É–ø–∞.
'''

import json
from Task4 import  User

from Task3 import AccesErorr, LevelError

class UserWorkshop:
    user_list = set()

    def __init__(self):
        UserWorkshop.load_users()
        pass


    @staticmethod
    def load_users(path: str = 'users2.json'):
        with open(path, 'r', encoding='UTF-8') as f:
            user_dict = json.load(f)
        for level, user_list in user_dict.items():
            for id, name in user_list.items():
                UserWorkshop.user_list.add(User(name, str(id), str(level)))  # —Å–æ–∑–¥–∞–ª–∏ –æ–±—ä–µ–∫—Ç—ã User –∏ –∑–∞–ø–∏—Å–∞–ª–∏ –≤–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ


    def login(self, name: str, id: str) -> str:                 #–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ—Å–ª–∏ –µ—Å—Ç—å —Ç–∞–∫–æ–π —Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        login_user = User(name, id)
        for user in UserWorkshop.user_list:
            if login_user == user:                  # –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –±–ª–∞–≥–æ–¥–∞—Ä—è __eq__ –∏ __hash__ –≤ –∫–ª–∞—Å—Å–µ User (—Ä–∞–≤–Ω—ã –∫–æ–≥–¥–∞ –∏–º—è –∏ id —Ä–∞–≤–Ω—ã)
                return user.level
        else:
            raise AccesErorr(name)                  # –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ  –æ—à–∏–±–∫–∏ –ø—Ä–æ–ø–∏—Å–∞–Ω–Ω–æ–π –≤ –º–æ–¥—É–ª–µ task3.py

    def create_user(self, name: str, id: str, level: str):                      # —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞–µ—Ç–ª—è –µ—Å–ª–∏ —É—Ä–æ–≤–µ–Ω—å –º–µ–Ω—å—à–µ —á–µ–º –≤–∞—à —É—Ä–æ–≤–µ–Ω—å
        cur_name, cur_id = input("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∞–≤—Ç–æ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –µ–≥–æ id —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª: \n").split()        #–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–æ—Ç–æ—Ä—ã–π –µ—Å—Ç—å –≤ –±–∞–∑–µ)
        if current_level := self.login(cur_name, cur_id):                        # –µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ —É—Ä–æ–≤–µ–Ω—å —É –Ω–µ–≥–æ –Ω–µ 0
            if int(current_level) > int(level):
                return User(name, id, level)                            # —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ—Å–ª–∏ —É—Ä–æ–≤–µ–Ω—å –∞–≤—Ç–æ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã—à–µ —É—Ä–æ–≤–Ω—è —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–≥–æ –ø–æ–ª—å–∑–æ–≤
            else:
                raise LevelError(current_level, level)


b = UserWorkshop()
print(b.login('Nesterov', '1')) #(–∏–º—è, id)  —É—Ä–æ–≤–µ–Ω—å = 5
print(b.create_user('New_user', '1', '3'))  #—Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–º—è, id, —É—Ä–æ–≤–µ–Ω—å) –≤ —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –µ–≥–æ —É—Ä–æ–≤–µ–Ω—å –º–µ–Ω—å—à–µ, —á–µ–º —É—Ä–æ–≤–µ–Ω—å —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
