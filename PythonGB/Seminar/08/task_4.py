'''
–ó–∞–¥–∞–Ω–∏–µ ‚Ññ4
üìå –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤ –ø—Ä–æ—à–ª–æ–º –∑–∞–¥–∞–Ω–∏–∏ csv —Ñ–∞–π–ª –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è csv.DictReader.
üìå –î–æ–ø–æ–ª–Ω–∏—Ç–µ id –¥–æ 10 —Ü–∏—Ñ—Ä –Ω–µ–∑–Ω–∞—á–∞—â–∏–º–∏ –Ω—É–ª—è–º–∏.
üìå –í –∏–º–µ–Ω–∞—Ö –ø–µ—Ä–≤—É—é –±—É–∫–≤—É —Å–¥–µ–ª–∞–π—Ç–µ –ø—Ä–æ–ø–∏—Å–Ω–æ–π.
üìå –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ —Ö–µ—à –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–º–µ–Ω–∏ –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞.
üìå –ü–æ–ª—É—á–∏–≤—à–∏–µ—Å—è –∑–∞–ø–∏—Å–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ json —Ñ–∞–π–ª, –≥–¥–µ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ csv —Ñ–∞–π–ª–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π json —Å–ª–æ–≤–∞—Ä—å.
üìå –ò–º—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏ –∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏.
'''

import csv
import json
from pathlib import Path


def csv_to_json(file_out: Path, file_in: Path) -> None:
    json_list = []
    with open(file_out, 'r+', encoding='utf-8') as csv_file:
        reader = csv.reader(csv_file)
        for i, row in enumerate(reader):
            if i == 0:
                continue
            json_dict = {}
            level, user_id, name = row
            json_dict['level'] = int(level)
            json_dict['id'] = user_id.zfill(10)  # .zfill(10) –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Å—Ç—Ä–æ–∫—É –Ω—É–ª—è–º–∏ —Å–ª–µ–≤–∞ –¥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã
            json_dict['name'] = name.title()  # –ú–µ—Ç–æ–¥ title() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É —Å –∑–∞–≥–ª–∞–≤–Ω–æ–π –ø–µ—Ä–≤–æ–π –±—É–∫–≤–æ–π
            json_dict['hash'] = hash(
                f'{user_id}{name}')  # –§—É–Ω–∫—Ü–∏—è hash() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å
            json_list.append(json_dict)

    with open(file_in, 'w', encoding='utf-8') as f:
        json.dump(json_list, f, indent=2, ensure_ascii=False)


if __name__ == '__main__':
    csv_to_json(Path('file2.csv'), Path('file2.json'))
